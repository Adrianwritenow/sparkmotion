---
phase: 27-dead-code-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/admin/src/components/bands/activity-feed.tsx
  - apps/customer/src/components/bands/activity-feed.tsx
  - apps/admin/src/components/events/city-autocomplete.tsx
  - apps/customer/src/components/events/city-autocomplete.tsx
  - packages/api/src/routers/bands.ts
  - packages/api/src/routers/bands.test.ts
  - .planning/phases/25-band-activity-tab-live-scan-tracking-time-based-filters-band-reassignment-nfc-scan-to-register-dialog-organizer-metadata-tags/25-VERIFICATION.md
autonomous: true
requirements:
  - INT-001
  - INT-002
  - INT-003
  - FLOW-001
  - FLOW-002
gap_closure: true

must_haves:
  truths:
    - "ActivityFeed component files no longer exist in either app"
    - "CityAutocomplete component files no longer exist in either app"
    - "bands.register procedure no longer exists in bands router"
    - "bands.register test block no longer exists in bands.test.ts"
    - "All remaining tests pass (expected ~78 tests after removing 2 bands.register tests)"
    - "Phase 25 VERIFICATION.md has Post-Phase Corrections section documenting commits aa5cf57 and 60003e2"
  artifacts:
    - path: "packages/api/src/routers/bands.ts"
      provides: "bands router without register procedure"
      contains: "activityFeed"
    - path: "packages/api/src/routers/bands.test.ts"
      provides: "bands tests without register tests"
  key_links:
    - from: "packages/api/src/routers/bands.ts"
      to: "packages/api/src/routers/bands.test.ts"
      via: "test coverage matches router procedures"
      pattern: "describe\\('bands\\."
---

<objective>
Delete all dead code identified in the v1.4 milestone audit: orphaned ActivityFeed components (both apps), orphaned CityAutocomplete components (both apps), and the orphaned bands.register tRPC procedure with its tests. Update Phase 25 VERIFICATION.md to document post-phase commits that invalidated verified truths.

Purpose: Close audit gaps INT-001, INT-002, INT-003, FLOW-001, FLOW-002 by removing dead code and correcting stale planning docs.
Output: Clean codebase with no orphaned components/procedures, updated verification docs.
</objective>

<execution_context>
@/Users/adrianrodriguez/.claude/get-shit-done/workflows/execute-plan.md
@/Users/adrianrodriguez/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/27-dead-code-cleanup/27-RESEARCH.md
@.planning/v1.4-MILESTONE-AUDIT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete dead component files and remove bands.register procedure</name>
  <files>
    apps/admin/src/components/bands/activity-feed.tsx
    apps/customer/src/components/bands/activity-feed.tsx
    apps/admin/src/components/events/city-autocomplete.tsx
    apps/customer/src/components/events/city-autocomplete.tsx
    packages/api/src/routers/bands.ts
    packages/api/src/routers/bands.test.ts
  </files>
  <action>
    Step 1: Delete 4 dead UI component files:
    - `rm apps/admin/src/components/bands/activity-feed.tsx`
    - `rm apps/customer/src/components/bands/activity-feed.tsx`
    - `rm apps/admin/src/components/events/city-autocomplete.tsx`
    - `rm apps/customer/src/components/events/city-autocomplete.tsx`

    Step 2: Verify no remaining imports of deleted files:
    - `grep -r "activity-feed\|ActivityFeed" apps/ --include="*.ts" --include="*.tsx"` — expect NO output
    - `grep -r "city-autocomplete\|CityAutocomplete" apps/ --include="*.ts" --include="*.tsx"` — expect NO output
    If any imports found, they are dangling and must also be removed (the research confirms none exist, but verify).

    Step 3: Remove the `bands.register` procedure from `packages/api/src/routers/bands.ts`:
    - Remove the entire `register: protectedProcedure` block starting at line 319 through the closing of its mutation handler (approximately line 367)
    - Do NOT remove `bands.activityFeed`, `bands.listAll`, `bands.bulkReassign`, or any other procedure
    - Do NOT modify `tags.ts` (tags.create/update/delete already removed in commit 60003e2)

    Step 4: Remove the `bands.register` test block from `packages/api/src/routers/bands.test.ts`:
    - Remove the `describe('bands.register', ...)` block starting at approximately line 155 (including the separator comment above it)
    - Do NOT remove tests for activityFeed, listAll, bulkReassign, or uploadBatch

    Step 5: Run tests to verify nothing is broken:
    - `pnpm --filter @sparkmotion/api test`
    - Expected: ~78 passing tests (80 minus the 2 removed bands.register tests)

    IMPORTANT — Do NOT delete these files (they are actively used):
    - `apps/*/src/components/bands/tag-badge.tsx` — used by BandReviewTable
    - `apps/*/src/components/bands/reassign-dialog.tsx` — used by BandReviewTable
    - `bands.activityFeed` procedure — valid backend logic for future use
    - `packages/geoip/` — directory already does not exist
  </action>
  <verify>
    <automated>cd /Users/adrianrodriguez/Desktop/sparkmotion && pnpm --filter @sparkmotion/api test 2>&1 | tail -5</automated>
    <manual>Confirm deleted files no longer appear in file listing: ls apps/admin/src/components/bands/activity-feed.tsx should fail</manual>
  </verify>
  <done>
    - 4 dead component files deleted (2 activity-feed.tsx, 2 city-autocomplete.tsx)
    - bands.register procedure removed from bands.ts
    - bands.register test block removed from bands.test.ts
    - All remaining tests pass (~78 tests)
    - No dangling imports in either app
  </done>
</task>

<task type="auto">
  <name>Task 2: Update Phase 25 VERIFICATION.md with post-phase corrections</name>
  <files>
    .planning/phases/25-band-activity-tab-live-scan-tracking-time-based-filters-band-reassignment-nfc-scan-to-register-dialog-organizer-metadata-tags/25-VERIFICATION.md
  </files>
  <action>
    Add a `## Post-Phase Corrections` section at the bottom of 25-VERIFICATION.md (before the final `_Verified:` line) documenting the post-phase commits that invalidated verified truths.

    Do NOT change:
    - `status: passed` in frontmatter (it was correct when verified)
    - `score: 16/16` in frontmatter (it was correct when verified)
    - Individual truth statuses from VERIFIED to FAILED (they were true at verification time)

    DO add:

    ```markdown
    ## Post-Phase Corrections

    After verification, two commits modified the Phase 25 codebase:

    ### Commit aa5cf57 (2026-02-22)
    Deleted NFC scan-to-register dialog and reverted tabbed bands layout to BandReviewTable-only.

    **Truths affected:**
    - Truth #9 (activity feed with 15s auto-refresh): ActivityFeed component no longer mounted in bands page
    - Truth #13 (NFC scan-to-register dialog): nfc-scan-register-dialog.tsx deleted from both apps

    ### Commit 60003e2 (2026-02-22)
    Removed TagsManagement component, stripped tags router to list-only, updated BandTag schema (title instead of name, no color field).

    **Truths affected:**
    - Truth #1 (BandTag with name, color fields): Schema now uses `title` (not `name`), no `color` field
    - Truth #4 (tags.create/update/delete): Procedures removed from tags.ts
    - Truth #14 (admin create/edit/delete tags): TagsManagement component deleted
    - Truth #16 (TagsManagement in admin bands page): Tags tab removed

    ### Impact
    These truths were accurate at verification time (2026-02-22T18:30:00Z). Post-phase commits intentionally removed these features. Dead code from these removals was cleaned up in Phase 27.
    ```

    Note: Truth #1 is also affected (BandTag schema changed from name+color to title-only) — this was identified during research but not in the original RESEARCH.md stale truths list. Include it for completeness.
  </action>
  <verify>
    <automated>grep -c "Post-Phase Corrections" "/Users/adrianrodriguez/Desktop/sparkmotion/.planning/phases/25-band-activity-tab-live-scan-tracking-time-based-filters-band-reassignment-nfc-scan-to-register-dialog-organizer-metadata-tags/25-VERIFICATION.md"</automated>
    <manual>Verify status: passed and score: 16/16 remain unchanged in frontmatter</manual>
  </verify>
  <done>
    - Phase 25 VERIFICATION.md has Post-Phase Corrections section
    - Documents commits aa5cf57 and 60003e2 with affected truths
    - Original verification status/score unchanged
    - Truths #1, #4, #9, #13, #14, #16 documented as post-phase invalidated
  </done>
</task>

</tasks>

<verification>
1. `ls apps/admin/src/components/bands/activity-feed.tsx` returns "No such file"
2. `ls apps/customer/src/components/bands/activity-feed.tsx` returns "No such file"
3. `ls apps/admin/src/components/events/city-autocomplete.tsx` returns "No such file"
4. `ls apps/customer/src/components/events/city-autocomplete.tsx` returns "No such file"
5. `grep -c "register:" packages/api/src/routers/bands.ts` returns 0
6. `grep -c "bands.register" packages/api/src/routers/bands.test.ts` returns 0
7. `pnpm --filter @sparkmotion/api test` passes with ~78 tests
8. `grep "Post-Phase Corrections" .planning/phases/25-*/25-VERIFICATION.md` returns a match
9. `grep "status: passed" .planning/phases/25-*/25-VERIFICATION.md` still returns a match
</verification>

<success_criteria>
- All 4 dead component files deleted from disk
- bands.register procedure removed from router
- bands.register tests removed from test file
- All remaining ~78 tests pass
- No dangling imports anywhere in apps/
- Phase 25 VERIFICATION.md updated with Post-Phase Corrections section
- Audit gaps INT-001, INT-002, INT-003, FLOW-001, FLOW-002 addressed
</success_criteria>

<output>
After completion, create `.planning/phases/27-dead-code-cleanup/27-01-SUMMARY.md`
</output>
